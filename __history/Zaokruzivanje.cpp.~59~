//---------------------------------------------------------------------------

#include <fmx.h>

#pragma hdrstop

#include <vector>
#include <stdlib.h>
#include <ctime>
#include <algorithm>
#include <windows.h>
#include <string>
#include <fstream>
#include <filesystem>

#include "Zaokruzivanje.h"
#include "Navigacija.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.fmx"
using namespace std;
TZaokruzivanjeForma *ZaokruzivanjeForma;
int izabran_odgovor;
int tacan_odg_rb;
int skor;
int broj_pokusaja=0;
int seed;

vector <String> pitanja;
vector <String> odg1;
vector <String> odg2;
vector <String> tacan_odg;
//---------------------------------------------------------------------------

void ocisti(){
	ZaokruzivanjeForma->Odgovor1->IsChecked = false;
	ZaokruzivanjeForma->Odgovor2->IsChecked = false;
	ZaokruzivanjeForma->Odgovor3->IsChecked = false;
	ZaokruzivanjeForma->Odgovor4->IsChecked = false;
}

void citaj(string path, vector<String> vektor){
	fstream neki_file;
	neki_file.open(path, ios::in);
	if(neki_file.is_open()){
		string line;
		while (getline(neki_file, line)){

		String novi_string(line.c_str());
		vektor.push_back(novi_string);

		}
		ZaokruzivanjeForma->Label1->Text = pitanja.size();
		neki_file.close();

	}
	else{
		ZaokruzivanjeForma->Label1->Text = "nije otvorfeno" ;
	}
}

void izmjesaj_pitanja(){

	citaj("C:/Users/korisnik/Desktop/KVIZ/pitanja.txt", pitanja);
	citaj("C:/Users/korisnik/Desktop/KVIZ/odg1.txt", odg1);
	citaj("C:/Users/korisnik/Desktop/KVIZ/odg2.txt", odg2);
	citaj("C:/Users/korisnik/Desktop/KVIZ/tacanOdg.txt", tacan_odg);

	srand(time(NULL));
	seed = rand()%20+1;

	std::srand (seed);
	random_shuffle(pitanja.begin(), pitanja.end());

	std::srand (seed);
	random_shuffle(odg1.begin(), odg1.end());

	std::srand (seed);
	random_shuffle(odg2.begin(), odg2.end());

	std::srand (seed);
	random_shuffle(tacan_odg.begin(), tacan_odg.end());
}

__fastcall TZaokruzivanjeForma::TZaokruzivanjeForma(TComponent* Owner)
	: TForm(Owner)
{
	izmjesaj_pitanja();
	srand(time(NULL));
	rand();
	tacan_odg_rb = rand()% 3 + 1;
	TekstPitanja->Text = pitanja[broj_pokusaja];

	if(tacan_odg_rb == 1){
		Odgovor1->Text = tacan_odg[broj_pokusaja];
		Odgovor2->Text = odg1[broj_pokusaja];
		Odgovor3->Text = odg2[broj_pokusaja];
	}
	else if(tacan_odg_rb == 2){
		Odgovor1->Text = odg1[broj_pokusaja];
		Odgovor2->Text = tacan_odg[broj_pokusaja];
		Odgovor3->Text = odg2[broj_pokusaja];
	}
	else{
        Odgovor1->Text = odg1[broj_pokusaja];
		Odgovor2->Text = odg2[broj_pokusaja];
		Odgovor3->Text = tacan_odg[broj_pokusaja];
    }
	Odgovor4->Text = "Ne znam";
	TrenutniBodovi->Text = skor;
}
//---------------------------------------------------------------------------
void __fastcall TZaokruzivanjeForma::Odgovor1Change(TObject *Sender)
{
	izabran_odgovor = 1;
}
//---------------------------------------------------------------------------
void __fastcall TZaokruzivanjeForma::Odgovor2Change(TObject *Sender)
{
    izabran_odgovor = 2;
}
//---------------------------------------------------------------------------
void __fastcall TZaokruzivanjeForma::Odgovor3Change(TObject *Sender)
{
    izabran_odgovor = 3;
}
//---------------------------------------------------------------------------
void __fastcall TZaokruzivanjeForma::Odgovor4Change(TObject *Sender)
{
    izabran_odgovor = 4;
}
//---------------------------------------------------------------------------
void __fastcall TZaokruzivanjeForma::PotvrdiButtonClick(TObject *Sender)
{


	int a;
	srand(time(NULL));
	rand();
	if(tacan_odg_rb == 1){

					if(izabran_odgovor == 1) skor = skor + 3;
					else if(izabran_odgovor == 4) skor = skor;
					else  skor = skor - 1;
					ocisti();
					}

			else if(tacan_odg_rb == 2){
					if(izabran_odgovor == 2) skor = skor + 3;
					else if(izabran_odgovor == 4) skor = skor;
					else skor = skor - 1;
					ocisti();
					}

			else if(tacan_odg_rb == 3){
					if(izabran_odgovor == 3) skor = skor + 3;
					else if(izabran_odgovor == 4) skor = skor;
					else  skor = skor - 1;
                    ocisti();

				}
                broj_pokusaja++;

	if(broj_pokusaja < pitanja.size()){
    tacan_odg_rb = rand()% 3 + 1;
			TekstPitanja->Text = pitanja[broj_pokusaja];
			if(tacan_odg_rb==1){
				Odgovor1->Text = tacan_odg[broj_pokusaja];
				a = rand()%2+1;
				if(a==1){
					Odgovor2->Text = odg1[broj_pokusaja];
					Odgovor3->Text = odg2[broj_pokusaja];
				}
				else{
					Odgovor2->Text = odg2[broj_pokusaja];
					Odgovor3->Text = odg1[broj_pokusaja];
				}
			}
			else if(tacan_odg_rb==2){
				Odgovor2->Text = tacan_odg[broj_pokusaja];
				a = rand()%2+1;
				if(a==1){
					Odgovor1->Text = odg1[broj_pokusaja];
					Odgovor3->Text = odg2[broj_pokusaja];
				}
				else{
					Odgovor1->Text = odg2[broj_pokusaja];
					Odgovor3->Text = odg1[broj_pokusaja];
				}
			}
			else if(tacan_odg_rb==3){
				Odgovor3->Text = tacan_odg[broj_pokusaja];
				a = rand()%2+1;
				if(a==1){
					Odgovor1->Text = odg1[broj_pokusaja];
					Odgovor2->Text = odg2[broj_pokusaja];
				}
				else{
					Odgovor1->Text = odg2[broj_pokusaja];
					Odgovor2->Text = odg1[broj_pokusaja];
				}
			}
			Odgovor4->Text = "Ne znam";

	}
	else{
		NavigacijaForma->ZaokruziButton->Enabled = false;
		NavigacijaForma->ukupni_bodovi += skor;
		NavigacijaForma->UkupniBodovi->Text = NavigacijaForma->ukupni_bodovi;
		this->Close();
		NavigacijaForma->Show();
	}

	TrenutniBodovi->Text = skor;
}
//---------------------------------------------------------------------------
